Running:
data_size_analysis_act.py --seed=2 --pure

Namespace(alpha=12, dataset_name='tqa_mc2', device=0, info_name='ft:davinci-002:university-of-edinburgh:info:8ejuTaQe', judge_name='ft:davinci-002:university-of-edinburgh::8ejp8D64', model_name='llama_7B', n_clusters=3, num_fold=1, num_heads=24, probe_base_weight=0.5, probe_type='prob', pure=True, seed=2, train_ratio=0.9, val_ratio=0.2)
experiments_path: /data/jxf/honest_llm/cluster_experiments/data_analyze_llama_7B_seed2_pure
Found cached dataset parquet (/data/jxf/.cache/huggingface/datasets/parquet/default-45ee6c5a774c2d3f/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 176.76it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.12s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.47s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.87s/it]
Found cached dataset parquet (/data/jxf/.cache/huggingface/datasets/parquet/default-45ee6c5a774c2d3f/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 286.93it/s]
Running fold 0
gen cluster-3 mean directions::   0%|          | 0/32 [00:00<?, ?it/s]gen cluster-3 mean directions::   3%|▎         | 1/32 [00:01<00:51,  1.67s/it]gen cluster-3 mean directions::   6%|▋         | 2/32 [00:03<00:44,  1.47s/it]gen cluster-3 mean directions::   9%|▉         | 3/32 [00:04<00:39,  1.37s/it]gen cluster-3 mean directions::  12%|█▎        | 4/32 [00:05<00:37,  1.34s/it]gen cluster-3 mean directions::  16%|█▌        | 5/32 [00:06<00:35,  1.31s/it]gen cluster-3 mean directions::  19%|█▉        | 6/32 [00:08<00:36,  1.40s/it]gen cluster-3 mean directions::  22%|██▏       | 7/32 [00:09<00:35,  1.41s/it]gen cluster-3 mean directions::  25%|██▌       | 8/32 [00:11<00:33,  1.40s/it]gen cluster-3 mean directions::  28%|██▊       | 9/32 [00:13<00:35,  1.54s/it]gen cluster-3 mean directions::  31%|███▏      | 10/32 [00:14<00:33,  1.53s/it]gen cluster-3 mean directions::  34%|███▍      | 11/32 [00:20<01:03,  3.01s/it]gen cluster-3 mean directions::  38%|███▊      | 12/32 [00:25<01:07,  3.39s/it]gen cluster-3 mean directions::  41%|████      | 13/32 [00:28<01:05,  3.46s/it]gen cluster-3 mean directions::  44%|████▍     | 14/32 [00:34<01:12,  4.05s/it]gen cluster-3 mean directions::  47%|████▋     | 15/32 [00:37<01:06,  3.94s/it]gen cluster-3 mean directions::  50%|█████     | 16/32 [00:44<01:14,  4.68s/it]gen cluster-3 mean directions::  53%|█████▎    | 17/32 [00:46<00:57,  3.83s/it]gen cluster-3 mean directions::  56%|█████▋    | 18/32 [00:49<00:50,  3.62s/it]gen cluster-3 mean directions::  59%|█████▉    | 19/32 [00:53<00:48,  3.76s/it]gen cluster-3 mean directions::  62%|██████▎   | 20/32 [00:55<00:38,  3.23s/it]gen cluster-3 mean directions::  66%|██████▌   | 21/32 [00:59<00:37,  3.45s/it]gen cluster-3 mean directions::  69%|██████▉   | 22/32 [01:05<00:44,  4.40s/it]gen cluster-3 mean directions::  72%|███████▏  | 23/32 [01:12<00:45,  5.01s/it]gen cluster-3 mean directions::  75%|███████▌  | 24/32 [01:14<00:33,  4.20s/it]gen cluster-3 mean directions::  78%|███████▊  | 25/32 [01:18<00:29,  4.20s/it]gen cluster-3 mean directions::  81%|████████▏ | 26/32 [01:24<00:27,  4.50s/it]gen cluster-3 mean directions::  84%|████████▍ | 27/32 [01:27<00:20,  4.14s/it]gen cluster-3 mean directions::  88%|████████▊ | 28/32 [01:30<00:15,  3.86s/it]gen cluster-3 mean directions::  91%|█████████ | 29/32 [01:36<00:13,  4.59s/it]gen cluster-3 mean directions::  94%|█████████▍| 30/32 [01:39<00:07,  3.95s/it]gen cluster-3 mean directions::  97%|█████████▋| 31/32 [01:43<00:04,  4.16s/it]gen cluster-3 mean directions:: 100%|██████████| 32/32 [01:48<00:00,  4.41s/it]gen cluster-3 mean directions:: 100%|██████████| 32/32 [01:48<00:00,  3.41s/it]
train probes:   0%|          | 0/32 [00:00<?, ?it/s]train probes:   3%|▎         | 1/32 [00:15<08:06, 15.70s/it]train probes:   6%|▋         | 2/32 [00:28<07:07, 14.26s/it]train probes:   9%|▉         | 3/32 [00:42<06:40, 13.82s/it]train probes:  12%|█▎        | 4/32 [00:54<06:13, 13.32s/it]train probes:  16%|█▌        | 5/32 [01:07<05:53, 13.09s/it]train probes:  19%|█▉        | 6/32 [01:19<05:34, 12.85s/it]train probes:  22%|██▏       | 7/32 [01:32<05:18, 12.72s/it]train probes:  25%|██▌       | 8/32 [01:44<05:04, 12.67s/it]train probes:  28%|██▊       | 9/32 [01:57<04:51, 12.68s/it]train probes:  31%|███▏      | 10/32 [02:10<04:39, 12.69s/it]train probes:  34%|███▍      | 11/32 [02:22<04:24, 12.60s/it]train probes:  38%|███▊      | 12/32 [02:35<04:10, 12.51s/it]train probes:  41%|████      | 13/32 [02:47<03:57, 12.49s/it]train probes:  44%|████▍     | 14/32 [03:00<03:45, 12.51s/it]train probes:  47%|████▋     | 15/32 [03:12<03:32, 12.49s/it]train probes:  50%|█████     | 16/32 [03:24<03:19, 12.48s/it]train probes:  53%|█████▎    | 17/32 [03:37<03:08, 12.56s/it]train probes:  56%|█████▋    | 18/32 [03:50<02:56, 12.63s/it]train probes:  59%|█████▉    | 19/32 [04:03<02:44, 12.65s/it]train probes:  62%|██████▎   | 20/32 [04:18<02:40, 13.35s/it]train probes:  66%|██████▌   | 21/32 [04:31<02:25, 13.21s/it]train probes:  69%|██████▉   | 22/32 [04:44<02:12, 13.23s/it]train probes:  72%|███████▏  | 23/32 [04:57<01:58, 13.19s/it]train probes:  75%|███████▌  | 24/32 [05:10<01:45, 13.15s/it]train probes:  78%|███████▊  | 25/32 [05:24<01:33, 13.37s/it]train probes:  81%|████████▏ | 26/32 [05:37<01:20, 13.42s/it]train probes:  84%|████████▍ | 27/32 [05:51<01:06, 13.34s/it]train probes:  88%|████████▊ | 28/32 [06:04<00:53, 13.44s/it]train probes:  91%|█████████ | 29/32 [06:17<00:40, 13.40s/it]train probes:  94%|█████████▍| 30/32 [06:31<00:26, 13.43s/it]train probes:  97%|█████████▋| 31/32 [06:44<00:13, 13.38s/it]train probes: 100%|██████████| 32/32 [06:57<00:00, 13.34s/it]train probes: 100%|██████████| 32/32 [06:57<00:00, 13.06s/it]
ASSUMES OPENAI_API_KEY ENVIRONMENT VARIABLE IS SET
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
  0%|          | 0/81 [00:00<?, ?it/s]/data/jxf/anaconda3/envs/iti/lib/python3.8/site-packages/transformers/generation/configuration_utils.py:377: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `1` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
  1%|          | 1/81 [00:05<07:23,  5.55s/it]  2%|▏         | 2/81 [00:10<06:29,  4.93s/it]  4%|▎         | 3/81 [00:14<06:09,  4.74s/it]  5%|▍         | 4/81 [00:19<06:18,  4.91s/it]  6%|▌         | 5/81 [00:24<06:10,  4.87s/it]  7%|▋         | 6/81 [00:29<05:56,  4.75s/it]  9%|▊         | 7/81 [00:33<05:56,  4.81s/it] 10%|▉         | 8/81 [00:38<05:46,  4.74s/it] 11%|█         | 9/81 [00:43<05:48,  4.84s/it] 12%|█▏        | 10/81 [00:48<05:39,  4.78s/it] 14%|█▎        | 11/81 [00:53<05:35,  4.80s/it] 15%|█▍        | 12/81 [00:57<05:31,  4.80s/it] 16%|█▌        | 13/81 [01:02<05:21,  4.73s/it] 17%|█▋        | 14/81 [01:07<05:17,  4.74s/it] 19%|█▊        | 15/81 [01:12<05:18,  4.82s/it] 20%|█▉        | 16/81 [01:17<05:22,  4.96s/it] 21%|██        | 17/81 [01:22<05:18,  4.98s/it] 22%|██▏       | 18/81 [01:27<05:08,  4.90s/it] 23%|██▎       | 19/81 [01:31<04:57,  4.81s/it] 25%|██▍       | 20/81 [01:37<05:02,  4.96s/it] 26%|██▌       | 21/81 [01:41<04:53,  4.89s/it] 27%|██▋       | 22/81 [01:46<04:46,  4.86s/it] 28%|██▊       | 23/81 [01:51<04:37,  4.79s/it] 30%|██▉       | 24/81 [01:56<04:37,  4.86s/it] 31%|███       | 25/81 [02:01<04:31,  4.84s/it] 32%|███▏      | 26/81 [02:06<04:27,  4.86s/it] 33%|███▎      | 27/81 [02:11<04:25,  4.91s/it] 35%|███▍      | 28/81 [02:16<04:21,  4.94s/it] 36%|███▌      | 29/81 [02:21<04:18,  4.97s/it] 37%|███▋      | 30/81 [02:26<04:21,  5.12s/it] 38%|███▊      | 31/81 [02:31<04:11,  5.04s/it] 40%|███▉      | 32/81 [02:36<04:02,  4.94s/it] 41%|████      | 33/81 [02:41<03:58,  4.96s/it] 42%|████▏     | 34/81 [02:45<03:49,  4.88s/it] 43%|████▎     | 35/81 [02:50<03:43,  4.85s/it] 44%|████▍     | 36/81 [02:56<03:47,  5.06s/it] 46%|████▌     | 37/81 [03:05<04:40,  6.37s/it] 47%|████▋     | 38/81 [03:10<04:13,  5.88s/it] 48%|████▊     | 39/81 [03:15<03:53,  5.57s/it] 49%|████▉     | 40/81 [03:19<03:38,  5.32s/it] 51%|█████     | 41/81 [03:25<03:30,  5.27s/it] 52%|█████▏    | 42/81 [03:29<03:18,  5.08s/it] 53%|█████▎    | 43/81 [03:34<03:07,  4.94s/it] 54%|█████▍    | 44/81 [03:39<03:02,  4.93s/it] 56%|█████▌    | 45/81 [03:44<02:57,  4.92s/it] 57%|█████▋    | 46/81 [03:48<02:47,  4.80s/it] 58%|█████▊    | 47/81 [03:52<02:37,  4.64s/it] 59%|█████▉    | 48/81 [03:57<02:31,  4.58s/it] 60%|██████    | 49/81 [04:02<02:31,  4.73s/it] 62%|██████▏   | 50/81 [04:07<02:24,  4.67s/it] 63%|██████▎   | 51/81 [04:11<02:17,  4.60s/it] 64%|██████▍   | 52/81 [04:15<02:11,  4.55s/it] 65%|██████▌   | 53/81 [04:20<02:08,  4.59s/it] 67%|██████▋   | 54/81 [04:25<02:09,  4.81s/it] 68%|██████▊   | 55/81 [04:30<02:04,  4.79s/it] 69%|██████▉   | 56/81 [04:35<01:57,  4.68s/it] 70%|███████   | 57/81 [04:40<01:54,  4.79s/it] 72%|███████▏  | 58/81 [04:44<01:47,  4.67s/it] 73%|███████▎  | 59/81 [04:49<01:44,  4.74s/it] 74%|███████▍  | 60/81 [04:53<01:38,  4.69s/it] 75%|███████▌  | 61/81 [04:58<01:34,  4.71s/it] 77%|███████▋  | 62/81 [05:03<01:30,  4.77s/it] 78%|███████▊  | 63/81 [05:08<01:26,  4.83s/it] 79%|███████▉  | 64/81 [05:13<01:23,  4.89s/it] 80%|████████  | 65/81 [05:17<01:15,  4.72s/it] 81%|████████▏ | 66/81 [05:22<01:09,  4.64s/it] 83%|████████▎ | 67/81 [05:27<01:05,  4.70s/it] 84%|████████▍ | 68/81 [05:31<01:00,  4.63s/it] 85%|████████▌ | 69/81 [05:36<00:57,  4.78s/it] 86%|████████▋ | 70/81 [05:41<00:51,  4.66s/it] 88%|████████▊ | 71/81 [05:46<00:48,  4.81s/it] 89%|████████▉ | 72/81 [05:50<00:42,  4.74s/it] 90%|█████████ | 73/81 [05:55<00:38,  4.78s/it] 91%|█████████▏| 74/81 [06:04<00:42,  6.01s/it] 93%|█████████▎| 75/81 [06:09<00:33,  5.57s/it] 94%|█████████▍| 76/81 [06:13<00:26,  5.31s/it] 95%|█████████▌| 77/81 [06:18<00:20,  5.22s/it] 96%|█████████▋| 78/81 [06:23<00:15,  5.01s/it] 98%|█████████▊| 79/81 [06:29<00:10,  5.17s/it] 99%|█████████▉| 80/81 [06:35<00:05,  5.44s/it]100%|██████████| 81/81 [06:41<00:00,  5.82s/it]100%|██████████| 81/81 [06:41<00:00,  4.96s/it]
  0%|          | 0/81 [00:00<?, ?it/s]  1%|          | 1/81 [00:01<02:30,  1.88s/it]  2%|▏         | 2/81 [00:02<01:52,  1.42s/it]  4%|▎         | 3/81 [00:04<01:38,  1.26s/it]  5%|▍         | 4/81 [00:05<01:27,  1.14s/it]  6%|▌         | 5/81 [00:06<01:36,  1.27s/it]  7%|▋         | 6/81 [00:07<01:33,  1.25s/it]  9%|▊         | 7/81 [00:08<01:28,  1.20s/it] 10%|▉         | 8/81 [00:09<01:22,  1.14s/it] 11%|█         | 9/81 [00:12<02:05,  1.74s/it] 12%|█▏        | 10/81 [00:13<01:49,  1.54s/it] 14%|█▎        | 11/81 [00:15<01:40,  1.44s/it] 15%|█▍        | 12/81 [00:17<02:00,  1.75s/it] 16%|█▌        | 13/81 [00:18<01:36,  1.42s/it] 17%|█▋        | 14/81 [00:19<01:30,  1.34s/it] 19%|█▊        | 15/81 [00:20<01:18,  1.19s/it] 20%|█▉        | 16/81 [00:21<01:18,  1.21s/it] 21%|██        | 17/81 [00:22<01:03,  1.01it/s] 22%|██▏       | 18/81 [00:24<01:24,  1.33s/it] 23%|██▎       | 19/81 [00:25<01:22,  1.34s/it] 25%|██▍       | 20/81 [00:27<01:41,  1.66s/it] 26%|██▌       | 21/81 [00:29<01:33,  1.56s/it] 27%|██▋       | 22/81 [00:30<01:23,  1.42s/it] 28%|██▊       | 23/81 [00:31<01:10,  1.21s/it] 30%|██▉       | 24/81 [00:32<01:14,  1.31s/it] 31%|███       | 25/81 [00:34<01:25,  1.52s/it] 32%|███▏      | 26/81 [00:35<01:15,  1.37s/it] 33%|███▎      | 27/81 [00:37<01:14,  1.38s/it] 35%|███▍      | 28/81 [00:38<01:11,  1.35s/it] 36%|███▌      | 29/81 [00:39<01:08,  1.31s/it] 37%|███▋      | 30/81 [00:41<01:13,  1.44s/it] 38%|███▊      | 31/81 [00:43<01:16,  1.53s/it] 40%|███▉      | 32/81 [00:44<01:09,  1.41s/it] 41%|████      | 33/81 [00:45<01:13,  1.52s/it] 42%|████▏     | 34/81 [00:46<00:59,  1.27s/it] 43%|████▎     | 35/81 [00:47<00:56,  1.23s/it] 44%|████▍     | 36/81 [00:48<00:49,  1.11s/it] 46%|████▌     | 37/81 [00:49<00:50,  1.14s/it] 47%|████▋     | 38/81 [00:50<00:45,  1.05s/it] 48%|████▊     | 39/81 [00:52<00:54,  1.30s/it] 49%|████▉     | 40/81 [00:53<00:46,  1.13s/it] 51%|█████     | 41/81 [00:57<01:22,  2.07s/it] 52%|█████▏    | 42/81 [01:00<01:27,  2.25s/it] 53%|█████▎    | 43/81 [01:00<01:07,  1.79s/it] 54%|█████▍    | 44/81 [01:02<01:09,  1.87s/it] 56%|█████▌    | 45/81 [01:03<00:57,  1.59s/it] 57%|█████▋    | 46/81 [01:05<00:51,  1.48s/it] 58%|█████▊    | 47/81 [01:06<00:45,  1.32s/it] 59%|█████▉    | 48/81 [01:07<00:46,  1.41s/it] 60%|██████    | 49/81 [01:08<00:43,  1.36s/it] 62%|██████▏   | 50/81 [01:10<00:40,  1.32s/it] 63%|██████▎   | 51/81 [01:10<00:34,  1.16s/it] 64%|██████▍   | 52/81 [01:12<00:38,  1.34s/it] 65%|██████▌   | 53/81 [01:14<00:42,  1.52s/it] 67%|██████▋   | 54/81 [01:15<00:38,  1.43s/it] 68%|██████▊   | 55/81 [01:16<00:33,  1.28s/it] 69%|██████▉   | 56/81 [01:18<00:34,  1.38s/it] 70%|███████   | 57/81 [01:20<00:34,  1.46s/it] 72%|███████▏  | 58/81 [01:20<00:29,  1.27s/it] 73%|███████▎  | 59/81 [01:22<00:28,  1.30s/it] 74%|███████▍  | 60/81 [01:23<00:24,  1.15s/it] 75%|███████▌  | 61/81 [01:25<00:31,  1.59s/it]