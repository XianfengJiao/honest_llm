Running:
data_size_analysis_act.py --seed=42 --pure

Namespace(alpha=12, dataset_name='tqa_mc2', device=0, info_name='ft:davinci-002:university-of-edinburgh:info:8ejuTaQe', judge_name='ft:davinci-002:university-of-edinburgh::8ejp8D64', model_name='llama_7B', n_clusters=3, num_fold=1, num_heads=24, probe_base_weight=0.5, probe_type='prob', pure=True, seed=42, train_ratio=0.9, val_ratio=0.2)
experiments_path: /data/jxf/honest_llm/cluster_experiments/data_analyze_llama_7B_seed42_pure
Found cached dataset parquet (/home/jxf/.cache/huggingface/datasets/parquet/default-45ee6c5a774c2d3f/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 199.80it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LlamaTokenizer'. 
The class this function is called from is 'LLaMATokenizer'.
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.54s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.05s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.42s/it]
Found cached dataset parquet (/home/jxf/.cache/huggingface/datasets/parquet/default-45ee6c5a774c2d3f/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 375.83it/s]
Running fold 0
gen cluster-3 mean directions::   0%|          | 0/32 [00:00<?, ?it/s]gen cluster-3 mean directions::   3%|▎         | 1/32 [00:01<00:48,  1.57s/it]gen cluster-3 mean directions::   6%|▋         | 2/32 [00:02<00:41,  1.40s/it]gen cluster-3 mean directions::   9%|▉         | 3/32 [00:04<00:38,  1.32s/it]gen cluster-3 mean directions::  12%|█▎        | 4/32 [00:05<00:35,  1.28s/it]gen cluster-3 mean directions::  16%|█▌        | 5/32 [00:06<00:34,  1.26s/it]gen cluster-3 mean directions::  19%|█▉        | 6/32 [00:07<00:32,  1.27s/it]gen cluster-3 mean directions::  22%|██▏       | 7/32 [00:09<00:31,  1.26s/it]gen cluster-3 mean directions::  25%|██▌       | 8/32 [00:10<00:30,  1.26s/it]gen cluster-3 mean directions::  28%|██▊       | 9/32 [00:11<00:28,  1.26s/it]gen cluster-3 mean directions::  31%|███▏      | 10/32 [00:12<00:28,  1.29s/it]gen cluster-3 mean directions::  34%|███▍      | 11/32 [00:14<00:27,  1.30s/it]gen cluster-3 mean directions::  38%|███▊      | 12/32 [00:15<00:26,  1.32s/it]gen cluster-3 mean directions::  41%|████      | 13/32 [00:16<00:25,  1.33s/it]gen cluster-3 mean directions::  44%|████▍     | 14/32 [00:18<00:23,  1.32s/it]gen cluster-3 mean directions::  47%|████▋     | 15/32 [00:19<00:22,  1.32s/it]gen cluster-3 mean directions::  50%|█████     | 16/32 [00:20<00:20,  1.31s/it]gen cluster-3 mean directions::  53%|█████▎    | 17/32 [00:22<00:19,  1.30s/it]gen cluster-3 mean directions::  56%|█████▋    | 18/32 [00:23<00:18,  1.29s/it]gen cluster-3 mean directions::  59%|█████▉    | 19/32 [00:24<00:16,  1.30s/it]gen cluster-3 mean directions::  62%|██████▎   | 20/32 [00:25<00:15,  1.27s/it]gen cluster-3 mean directions::  66%|██████▌   | 21/32 [00:27<00:13,  1.25s/it]gen cluster-3 mean directions::  69%|██████▉   | 22/32 [00:28<00:12,  1.25s/it]gen cluster-3 mean directions::  72%|███████▏  | 23/32 [00:29<00:11,  1.24s/it]gen cluster-3 mean directions::  75%|███████▌  | 24/32 [00:30<00:10,  1.25s/it]gen cluster-3 mean directions::  78%|███████▊  | 25/32 [00:32<00:08,  1.22s/it]gen cluster-3 mean directions::  81%|████████▏ | 26/32 [00:33<00:07,  1.21s/it]gen cluster-3 mean directions::  84%|████████▍ | 27/32 [00:34<00:06,  1.20s/it]gen cluster-3 mean directions::  88%|████████▊ | 28/32 [00:35<00:04,  1.20s/it]gen cluster-3 mean directions::  91%|█████████ | 29/32 [00:36<00:03,  1.24s/it]gen cluster-3 mean directions::  94%|█████████▍| 30/32 [00:38<00:02,  1.21s/it]gen cluster-3 mean directions::  97%|█████████▋| 31/32 [00:39<00:01,  1.19s/it]gen cluster-3 mean directions:: 100%|██████████| 32/32 [00:40<00:00,  1.20s/it]gen cluster-3 mean directions:: 100%|██████████| 32/32 [00:40<00:00,  1.26s/it]
train probes:   0%|          | 0/32 [00:00<?, ?it/s]train probes:   3%|▎         | 1/32 [00:11<05:45, 11.16s/it]train probes:   6%|▋         | 2/32 [00:21<05:24, 10.83s/it]train probes:   9%|▉         | 3/32 [00:34<05:42, 11.81s/it]train probes:  12%|█▎        | 4/32 [00:48<05:47, 12.41s/it]train probes:  16%|█▌        | 5/32 [01:00<05:38, 12.53s/it]train probes:  19%|█▉        | 6/32 [01:13<05:31, 12.73s/it]train probes:  22%|██▏       | 7/32 [01:26<05:18, 12.75s/it]train probes:  25%|██▌       | 8/32 [01:40<05:11, 12.99s/it]train probes:  28%|██▊       | 9/32 [01:51<04:48, 12.54s/it]train probes:  31%|███▏      | 10/32 [02:03<04:30, 12.31s/it]train probes:  34%|███▍      | 11/32 [02:15<04:16, 12.21s/it]train probes:  38%|███▊      | 12/32 [02:27<04:00, 12.03s/it]train probes:  41%|████      | 13/32 [02:38<03:45, 11.88s/it]train probes:  44%|████▍     | 14/32 [02:50<03:31, 11.75s/it]